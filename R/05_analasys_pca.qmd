```{r}
library(tidyr)
library('ggbiplot')
library(sjmisc) #Unofficial tidyverse package that follows the tidyverse syntax

#Data without rows with N/A excluding nonnumeric columns (-1:2)
#df_input <- df_norm[, -(1:2)] |> na.omit() |> rotate_df()

#Augmented data
df_input <- select(df_no_na_wide, -c(1,2,'O08759_group')) |> na.omit() |>
  mutate(across(everything(), ~ as.numeric(unlist(.))))

#Projecting data unto principal components (pc)
pc <- prcomp(df_input, center = FALSE, scale = FALSE)

#Gives overview of variability of PC
print(pc)

#Gives an overview, you should be able to tell the variance already here even without the plot.
summary(pc)

biplot <- ggbiplot(pc,
                   obs.scale = 0,
                   var.scale = 1,
                   var.factor = 1.5,
                   varname.adjust = 1.5,
                   varname.size = 3,
                   groups    = NULL, #visualises datagroups
                   ellipse   = FALSE,  #Probability elipse
                   ellipse.prob = 0.66, #Fraction of observations that should be in ellipse
                   circle    = FALSE,   #Unity circle representing structure correlation in variables
                   var.axes  = FALSE   #Variable vectors, can see correlation from if they're grouped
        )+
  theme(legend.position = 'top',aspect.ratio = 1)


print(biplot)
```
