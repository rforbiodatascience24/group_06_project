---
title: "05_analysis"
format: html
editor: visual
---

```{r}
library(purrr)
library(broom)
```

## Data Analysis

### PCA

### Volcano plots (pairwise)

T-test

```{r}

df_no_na_long |> 
  group_by(protein_groups, cell_type)

# create a tibble with mean values and standard deviation
df_no_na_long |> 
  group_by(protein_groups, cell_type) |> # take the mean/sd of of the replicates for the protein groups and cell types.
  summarise(
    p_value = t.test()
    )
df_mean_intensitities





flot <- df_no_na_long |> 
  filter(replicate_n != 5)
  


wide <- flot |> 
  pivot_wider(names_from = cell_type,
              values_from = intensity,
              values_fn = mean) # the pivot_wider finds duplicate values for intentcity, this is a way to mitigate that issue.




wide |> 
  group_by(genes) |>
  mutate(ttest = map(.x = hsc,
                     .f = ~ t.test(.x,
                                   alternative = c("two.sided",
                                                   "less",
                                                   "greater"),
                                   conf.level = 0.99)))



view(wide)
```

```{r}

krap <-df_mean_intensitities |> 
  select(!sd) |> 
  pivot_wider(names_from = cell_type, values_from = mean) |> 
  select(!gmp & !hsc & !mep) |> 
  mutate(fold = cmp/clp) 
  
```
